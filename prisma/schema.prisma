generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model databasechangelog {
  id            String   @db.VarChar(255)
  author        String   @db.VarChar(255)
  filename      String   @db.VarChar(255)
  dateexecuted  DateTime @db.Timestamp(6)
  orderexecuted Int
  exectype      String   @db.VarChar(10)
  md5sum        String?  @db.VarChar(35)
  description   String?  @db.VarChar(255)
  comments      String?  @db.VarChar(255)
  tag           String?  @db.VarChar(255)
  liquibase     String?  @db.VarChar(20)
  contexts      String?  @db.VarChar(255)
  labels        String?  @db.VarChar(255)
  deployment_id String?  @db.VarChar(10)

  @@ignore
}

model databasechangeloglock {
  id          Int       @id
  locked      Boolean
  lockgranted DateTime? @db.Timestamp(6)
  lockedby    String?   @db.VarChar(255)
}

model old_passwords {
  id                       BigInt    @id @default(autoincrement())
  encrypted_password       String    @db.VarChar(255)
  password_archivable_type String    @db.VarChar(255)
  password_archivable_id   Int
  created_at               DateTime? @db.Timestamp(6)

  @@index([password_archivable_type, password_archivable_id], map: "index_password_archivableddu")
}

model pafs_core_areas {
  id                   BigInt                 @id @default(autoincrement())
  name                 String?                @db.VarChar(255)
  parent_id            Int?
  area_type            String?                @db.VarChar(255)
  created_at           DateTime               @db.Timestamp(6)
  updated_at           DateTime               @db.Timestamp(6)
  sub_type             String?                @db.VarChar(255)
  identifier           String?                @db.VarChar(255)
  end_date             DateTime?              @db.Date
  pafs_core_user_areas pafs_core_user_areas[]

  @@index([name], map: "index_pafs_core_areas_on_name")
}

model pafs_core_user_areas {
  id              BigInt          @id @default(autoincrement())
  created_at      DateTime        @db.Timestamp(6)
  updated_at      DateTime        @db.Timestamp(6)
  user_id         BigInt
  area_id         BigInt
  primary         Boolean?        @default(false)
  pafs_core_areas pafs_core_areas @relation(fields: [area_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user_areas_area_id")
  pafs_core_users pafs_core_users @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user_areas_user_id")

  @@index([area_id], map: "index_pafs_core_user_areas_on_area_id")
  @@index([user_id], map: "index_pafs_core_user_areas_on_user_id")
}

model pafs_core_users {
  id                     BigInt                 @id @default(autoincrement())
  email                  String                 @unique(map: "index_pafs_core_users_on_email") @default("") @db.VarChar(255)
  encrypted_password     String                 @default("") @db.VarChar(255)
  reset_password_token   String?                @unique(map: "index_pafs_core_users_on_reset_password_token") @db.VarChar(255)
  reset_password_sent_at DateTime?              @db.Timestamp(6)
  remember_created_at    DateTime?              @db.Timestamp(6)
  sign_in_count          Int                    @default(0)
  current_sign_in_at     DateTime?              @db.Timestamp(6)
  last_sign_in_at        DateTime?              @db.Timestamp(6)
  current_sign_in_ip     String?                @db.Inet
  last_sign_in_ip        String?                @db.Inet
  failed_attempts        Int                    @default(0)
  unlock_token           String?                @unique(map: "index_pafs_core_users_on_unlock_token") @db.VarChar(255)
  locked_at              DateTime?              @db.Timestamp(6)
  first_name             String                 @default("") @db.VarChar(255)
  last_name              String                 @default("") @db.VarChar(255)
  job_title              String?                @db.VarChar(255)
  created_at             DateTime               @db.Timestamp(6)
  updated_at             DateTime               @db.Timestamp(6)
  invitation_token       String?                @unique(map: "index_pafs_core_users_on_invitation_token") @db.VarChar(255)
  invitation_created_at  DateTime?              @db.Timestamp(6)
  invitation_sent_at     DateTime?              @db.Timestamp(6)
  invitation_accepted_at DateTime?              @db.Timestamp(6)
  invitation_limit       Int?
  invited_by_id          Int?
  invited_by_type        String?                @db.VarChar(255)
  invitations_count      Int?                   @default(0)
  admin                  Boolean                @default(false)
  disabled               Boolean                @default(false)
  unique_session_id      String?                @db.VarChar(20)
  organisation           String                 @default("") @db.VarChar(255)
  telephone_number       String?                @db.VarChar(255)
  status                 String                 @default("active") @db.VarChar(255)
  pafs_core_user_areas   pafs_core_user_areas[]

  @@index([disabled], map: "index_pafs_core_users_on_disabled")
  @@index([invitations_count], map: "index_pafs_core_users_on_invitations_count")
  @@index([invited_by_id], map: "index_pafs_core_users_on_invited_by_id")
}

model pafs_core_projects {
  id                                                          BigInt    @id @default(autoincrement())
  reference_number                                            String    @db.VarChar(255)
  version                                                     Int
  slug                                                        String    @unique(map: "index_pafs_core_projects_on_slug") @default("") @db.VarChar(255)
  name                                                        String?   @unique(map: "index_pafs_core_projects_on_name") @db.VarChar(255)
  rma_name                                                    String?   @db.VarChar(255)
  project_type                                                String?   @db.VarChar(255)
  project_intervention_types                                  String?   @db.VarChar(255)
  main_intervention_type                                      String?   @db.VarChar(255)
  earliest_start_year                                         Int?
  project_end_financial_year                                  Int?
  pending_earliest_start_year                                 Int?
  pending_financial_year                                      Int?
  date_change_requires_confirmation                           Boolean   @default(false)
  grid_reference                                              String?   @db.VarChar(255)
  region                                                      String?   @db.VarChar(255)
  parliamentary_constituency                                  String?   @db.VarChar(255)
  county                                                      String?   @db.VarChar(255)
  project_location                                            String[]
  project_location_zoom_level                                 Int?      @default(15)
  benefit_area_file_name                                      String?   @db.VarChar(255)
  benefit_area_content_type                                   String?   @db.VarChar(255)
  benefit_area_file_size                                      Int?
  benefit_area_file_updated_at                                DateTime? @db.Timestamp(6)
  benefit_area                                                String?
  benefit_area_centre                                         String[]
  benefit_area_zoom_level                                     Int?
  start_outline_business_case_month                           Int?
  start_outline_business_case_year                            Int?
  complete_outline_business_case_month                        Int?
  complete_outline_business_case_year                         Int?
  award_contract_month                                        Int?
  award_contract_year                                         Int?
  start_construction_month                                    Int?
  start_construction_year                                     Int?
  ready_for_service_month                                     Int?
  ready_for_service_year                                      Int?
  could_start_early                                           Boolean?
  earliest_with_gia_month                                     Int?
  earliest_with_gia_year                                      Int?
  fcerm_gia                                                   Boolean?
  local_levy                                                  Boolean?
  internal_drainage_boards                                    Boolean?
  public_contributions                                        Boolean?
  public_contributor_names                                    String?   @db.VarChar(255)
  private_contributions                                       Boolean?
  private_contributor_names                                   String?   @db.VarChar(255)
  other_ea_contributions                                      Boolean?
  other_ea_contributor_names                                  String?   @db.VarChar(255)
  growth_funding                                              Boolean?
  not_yet_identified                                          Boolean?
  funding_sources_visited                                     Boolean?  @default(false)
  asset_replacement_allowance                                 Boolean?  @default(false)
  environment_statutory_funding                               Boolean?  @default(false)
  frequently_flooded_communities                              Boolean?  @default(false)
  other_additional_grant_in_aid                               Boolean?  @default(false)
  other_government_department                                 Boolean?  @default(false)
  recovery                                                    Boolean?  @default(false)
  summer_economic_fund                                        Boolean?  @default(false)
  project_risks_protected_against                             String?
  main_source_of_risk                                         String?   @db.VarChar(255)
  current_flood_risk                                          String?   @db.VarChar(255)
  current_coastal_erosion_risk                                String?   @db.VarChar(255)
  no_properties_at_flood_risk                                 Boolean?  @default(false)
  properties_benefit_maintaining_assets                       Int?
  properties_benefit_50_percent_reduction                     Int?
  properties_benefit_less_50_percent_reduction                Int?
  properties_benefit_individual_intervention                  Int?
  no_properties_at_coastal_erosion_risk                       Boolean?  @default(false)
  properties_benefit_maintaining_assets_coastal               Int?
  properties_benefit_investment_coastal_erosion               Int?
  percent_properties_20_percent_deprived                      Int?
  percent_properties_10_percent_deprived                      Int?
  environmental_benefits                                      Boolean?
  intertidal_habitat                                          Boolean?
  hectares_of_intertidal_habitat_created_or_enhanced          Float?
  woodland                                                    Boolean?
  hectares_of_woodland_habitat_created_or_enhanced            Float?
  wet_woodland                                                Boolean?
  hectares_of_wet_woodland_habitat_created_or_enhanced        Float?
  wetland_or_wet_grassland                                    Boolean?
  hectares_of_wetland_or_wet_grassland_created_or_enhanced    Float?
  grassland                                                   Boolean?
  hectares_of_grassland_habitat_created_or_enhanced           Float?
  heathland                                                   Boolean?
  hectares_of_heathland_created_or_enhanced                   Float?
  ponds_lakes                                                 Boolean?
  hectares_of_pond_or_lake_habitat_created_or_enhanced        Float?
  arable_land                                                 Boolean?
  hectares_of_arable_land_lake_habitat_created_or_enhanced    Float?
  comprehensive_restoration                                   Boolean?
  kilometres_of_watercourse_enhanced_or_created_comprehensive Float?
  partial_restoration                                         Boolean?
  kilometres_of_watercourse_enhanced_or_created_partial       Float?
  create_habitat_watercourse                                  Boolean?
  kilometres_of_watercourse_enhanced_or_created_single        Float?
  approach                                                    String?
  nfm_selected_measures                                       String?
  nfm_land_use_change                                         String?
  nfm_landowner_consent                                       String?   @db.VarChar(50)
  nfm_experience_level                                        String?   @db.VarChar(50)
  nfm_project_readiness                                       String?   @db.VarChar(50)
  wlc_estimated_whole_life_pv_costs                           Float?
  wlc_estimated_design_construction_costs                     Float?
  wlc_estimated_risk_contingency_costs                        Float?
  wlc_estimated_future_costs                                  Float?
  wlc_estimated_whole_life_pv_benefits                        Float?
  wlc_estimated_property_damages_avoided                      Float?
  wlc_estimated_environmental_benefits                        Float?
  wlc_estimated_recreation_tourism_benefits                   Float?
  wlc_estimated_land_value_uplift_benefits                    Float?
  urgency_reason                                              String?                          @db.VarChar(255)
  urgency_details                                             String?
  urgency_details_updated_at                                  DateTime?                        @db.Timestamp(6)
  confidence_homes_better_protected                           String?                          @db.VarChar(20)
  confidence_homes_by_gateway_four                            String?                          @db.VarChar(20)
  confidence_secured_partnership_funding                      String?                          @db.VarChar(20)
  carbon_cost_build                                           Decimal?                         @db.Decimal(20, 2)
  carbon_cost_operation                                       Decimal?                         @db.Decimal(20, 2)
  carbon_cost_sequestered                                     Decimal?                         @db.Decimal(20, 2)
  carbon_cost_avoided                                         Decimal?                         @db.Decimal(20, 2)
  carbon_savings_net_economic_benefit                         Decimal?                         @db.Decimal(20, 2)
  carbon_operational_cost_forecast                            BigInt?
  carbon_values_hexdigest                                     String?                          @db.VarChar(255)
  creator_id                                                  Int?
  submitted_at                                                DateTime?                        @db.Timestamp(6)
  submitted_to_pol                                            DateTime?                        @db.Timestamp(6)
  updated_by_type                                             String?                          @db.VarChar(255)
  updated_by_id                                               BigInt?
  created_at                                                  DateTime                         @db.Timestamp(6)
  updated_at                                                  DateTime                         @db.Timestamp(6)
  is_legacy                                                   Boolean                          @default(true)
  pafs_core_nfm_land_use_changes                              pafs_core_nfm_land_use_changes[]
  pafs_core_nfm_measures                                      pafs_core_nfm_measures[]

  @@unique([reference_number, version], map: "index_pafs_core_projects_on_reference_number_and_version")
  @@index([reference_number], map: "index_pafs_core_projects_on_reference_number")
  @@index([submitted_to_pol], map: "index_pafs_core_projects_on_submitted_to_pol")
  @@index([updated_by_type, updated_by_id], map: "index_pafs_core_projects_on_updated_by")
}

model pafs_core_area_downloads {
  id                                  BigInt    @id @default(autoincrement())
  area_id                             Int?
  user_id                             Int?
  requested_on                        DateTime? @db.Timestamp(6)
  number_of_proposals                 Int?
  fcerm1_filename                     String?   @db.VarChar(255)
  benefit_areas_filename              String?   @db.VarChar(255)
  moderation_filename                 String?   @db.VarChar(255)
  number_of_proposals_with_moderation Int?
  status                              String    @default("empty") @db.VarChar(255)
  funding_calculator_filename         String?   @db.VarChar(255)
  created_at                          DateTime? @db.Timestamp(6)
  updated_at                          DateTime? @db.Timestamp(6)

  @@index([area_id], map: "index_pafs_core_area_downloads_on_area_id")
}

model pafs_core_area_projects {
  id         BigInt   @id @default(autoincrement())
  area_id    Int
  project_id Int
  owner      Boolean? @default(false)
  created_at DateTime @db.Timestamp(6)
  updated_at DateTime @db.Timestamp(6)

  @@index([area_id], map: "index_pafs_core_area_projects_on_area_id")
  @@index([project_id], map: "index_pafs_core_area_projects_on_project_id")
}

model pafs_core_asite_files {
  id                  BigInt @id @default(autoincrement())
  asite_submission_id Int?
  filename            String @db.VarChar(255)
  checksum            String @db.VarChar(255)
}

model pafs_core_asite_submissions {
  id                       BigInt    @id @default(autoincrement())
  project_id               Int?
  email_sent_at            DateTime  @db.Timestamp(6)
  confirmation_received_at DateTime? @db.Timestamp(6)
  status                   String    @default("created") @db.VarChar(255)
}

model pafs_core_funding_contributors {
  id               BigInt   @id @default(autoincrement())
  name             String?  @db.VarChar(255)
  contributor_type String?  @db.VarChar(255)
  funding_value_id Int?
  amount           BigInt?
  secured          Boolean  @default(false)
  constrained      Boolean  @default(false)
  created_at       DateTime @db.Timestamp(6)
  updated_at       DateTime @db.Timestamp(6)

  @@index([funding_value_id, contributor_type], map: "funding_contributors_on_funding_value_id_and_type")
  @@index([contributor_type], map: "index_pafs_core_funding_contributors_on_contributor_type")
  @@index([funding_value_id], map: "index_pafs_core_funding_contributors_on_funding_value_id")
}

model pafs_core_funding_values {
  id                             BigInt  @id @default(autoincrement())
  project_id                     Int?
  financial_year                 Int
  fcerm_gia                      BigInt?
  local_levy                     BigInt?
  internal_drainage_boards       BigInt?
  public_contributions           BigInt?
  private_contributions          BigInt?
  other_ea_contributions         BigInt?
  not_yet_identified             BigInt?
  total                          BigInt  @default(0)
  asset_replacement_allowance    BigInt?
  environment_statutory_funding  BigInt?
  frequently_flooded_communities BigInt?
  other_additional_grant_in_aid  BigInt?
  other_government_department    BigInt?
  recovery                       BigInt?
  summer_economic_fund           BigInt?

  @@index([project_id, financial_year], map: "funding_values_on_project_id_and_financial_year")
  @@index([financial_year], map: "index_pafs_core_funding_values_on_financial_year")
  @@index([project_id], map: "index_pafs_core_funding_values_on_project_id")
}

model pafs_core_nfm_land_use_changes {
  id                   BigInt   @id @default(autoincrement())
  project_id           BigInt
  land_use_type        String   @db.VarChar(50)
  area_before_hectares Float
  area_after_hectares  Float
  created_at           DateTime @db.Timestamp(6)
  updated_at           DateTime @db.Timestamp(6)

  @@unique([project_id, land_use_type], map: "idx_nfm_land_use_unique")
  @@index([project_id], map: "idx_nfm_land_use_project_id")
}

model pafs_core_nfm_measures {
  id                BigInt   @id @default(autoincrement())
  project_id        BigInt
  measure_type      String   @db.VarChar(100)
  area_hectares     Float?
  storage_volume_m3 Float?
  length_km         Float?
  width_m           Float?
  created_at        DateTime @db.Timestamp(6)
  updated_at        DateTime @db.Timestamp(6)

  @@index([project_id], map: "idx_nfm_measures_project_id")
  @@index([measure_type], map: "idx_nfm_measures_type")
}

model pafs_core_reference_counters {
  id           BigInt   @id @default(autoincrement())
  rfcc_code    String   @unique(map: "index_pafs_core_reference_counters_on_rfcc_code") @default("") @db.VarChar(255)
  high_counter Int      @default(0)
  low_counter  Int      @default(0)
  created_at   DateTime @db.Timestamp(6)
  updated_at   DateTime @db.Timestamp(6)
}

model pafs_core_states {
  id         BigInt    @id @default(autoincrement())
  project_id Int?
  state      String    @default("draft") @db.VarChar(255)
  created_at DateTime? @db.Timestamp(6)
  updated_at DateTime? @db.Timestamp(6)
}

model scheduler_locks {
  task_name   String    @id @db.VarChar(255)
  locked_by   String    @db.VarChar(255)
  locked_at   DateTime  @db.Timestamp(6)
  expires_at  DateTime  @db.Timestamp(6)
  last_run_at DateTime? @db.Timestamp(6)

  @@index([expires_at], map: "idx_scheduler_locks_expires_at")
}

model scheduler_logs {
  id                   BigInt    @id @default(autoincrement())
  task_name            String    @db.VarChar(255)
  executed_by          String    @db.VarChar(255)
  status               String    @db.VarChar(50)
  started_at           DateTime  @db.Timestamp(6)
  completed_at         DateTime? @db.Timestamp(6)
  duration_ms          Int?
  result               String?
  error_message        String?
  error_stack          String?
  trigger_type         String    @db.VarChar(50)
  triggered_by_user_id BigInt?
  created_at           DateTime  @default(now()) @db.Timestamp(6)

  @@index([started_at], map: "idx_scheduler_logs_started_at")
  @@index([status], map: "idx_scheduler_logs_status")
  @@index([task_name], map: "idx_scheduler_logs_task_name")
  @@index([task_name, status], map: "idx_scheduler_logs_task_status")
}
